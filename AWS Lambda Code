import boto3

def lambda_handler(event, context):
    MyEventID = event.get("eid")
    MyEventName = event.get("ename")
    MyCustomerName = event.get("cname")
    MyCustomerAge = event.get("cage")
    MyCustomerEmail = event.get("cemail")

    # Insert item into DynamoDB
    boto3.resource("dynamodb").Table("eventManagement").put_item(
        Item={
            "eventID": MyEventID,
            "eventname": MyEventName,
            "customername": MyCustomerName,
            "customerage": MyCustomerAge,
            "customeremail": MyCustomerEmail
        }
    )

    # Send confirmation email via SES
    boto3.client("ses", region_name="ap-south-1").send_email(
        Source="uk144199@gmail.com",
        Destination={"ToAddresses": [MyCustomerEmail]},
        Message={
            "Subject": {"Data": "Event Registration Confirmation"},
            "Body": {
                "Text": {"Data": f"Your registration for the event {MyEventName} has been confirmed."}
            }
        }
    )
